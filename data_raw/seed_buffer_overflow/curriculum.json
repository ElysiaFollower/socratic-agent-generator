[
  {
    "step_title": "环境准备与防御措施关闭",
    "guiding_question": "想象一下，我们要研究一个古老的城堡防御系统，但首先需要暂时关闭现代安保设备。你认为为什么在安全研究中，有时需要先关闭防护机制来理解攻击原理？",
    "success_criteria": "学生能够解释关闭ASLR的原因，并成功配置实验环境",
    "learning_objective": "理解地址空间布局随机化(ASLR)的作用原理及其对缓冲区溢出攻击的影响"
  },
  {
    "step_title": "熟悉Shellcode",
    "guiding_question": "如果把缓冲区溢出比作向城堡内投递秘密指令，那么Shellcode就是这些指令的密码本。你认为为什么攻击者需要精心设计这些二进制代码？",
    "success_criteria": "学生能够修改Shellcode执行自定义命令，并理解其工作原理",
    "learning_objective": "掌握Shellcode的结构和工作原理，学会修改和测试自定义Shellcode"
  },
  {
    "step_title": "第一关攻击 - 已知地址攻击",
    "guiding_question": "现在你知道了城堡的精确地图和守卫换岗时间，你认为如何利用这些信息设计最有效的入侵方案？",
    "success_criteria": "成功利用已知缓冲区地址和帧指针信息获取root权限",
    "learning_objective": "理解函数调用栈的结构，掌握在已知内存布局情况下的精确溢出攻击技术"
  },
  {
    "step_title": "第二关攻击 - 未知精确地址攻击",
    "guiding_question": "如果现在你只知道城堡的大致区域，但不知道具体房间位置，你会如何设计攻击策略来提高成功率？",
    "success_criteria": "在仅知缓冲区地址范围的情况下成功获取root权限",
    "learning_objective": "掌握内存对齐原理和范围攻击技术，理解NOP雪橇在不确定性攻击中的作用"
  },
  {
    "step_title": "第三关攻击 - 64位系统挑战",
    "guiding_question": "从32位升级到64位就像从小镇搬到大都市，地址空间变大了，但交通规则也更复杂。你认为最大的挑战会是什么？",
    "success_criteria": "成功解决64位地址零字节问题并完成攻击",
    "learning_objective": "理解64位与32位架构差异，掌握处理地址零字节限制的技术"
  },
  {
    "step_title": "第四关攻击 - 小缓冲区环境",
    "guiding_question": "想象你只能通过一个很小的窗口向城堡内传递指令，你会如何优化你的攻击代码以适应这个限制？",
    "success_criteria": "在有限溢出空间内成功构造精确payload并获取权限",
    "learning_objective": "掌握在空间受限环境下的payload优化技术，理解最小化Shellcode的设计原则"
  },
  {
    "step_title": "地址随机化防护评估",
    "guiding_question": "如果城堡每天都会随机改变内部布局，你认为这对攻击者意味着什么？这种防护是绝对安全的吗？",
    "success_criteria": "能够分析ASLR对攻击成功率的影响，理解其防护原理和局限性",
    "learning_objective": "深入理解ASLR的工作原理，评估其在现实环境中的防护效果和可被绕过的条件"
  },
  {
    "step_title": "StackGuard防护机制分析",
    "guiding_question": "想象栈保护就像在城堡的关键通道设置哨兵，一旦有人擅闯就会报警。你认为这种机制能完全阻止入侵吗？",
    "success_criteria": "能够解释StackGuard的工作原理，分析其防护效果和潜在绕过方法",
    "learning_objective": "理解栈保护金丝雀(Canary)机制的工作原理和防护边界"
  },
  {
    "step_title": "不可执行栈防护评估",
    "guiding_question": "如果城堡规定某些区域只能存放物资但不能执行命令，这对攻击者的策略会产生什么根本性改变？",
    "success_criteria": "理解不可执行栈的防护原理，能够分析其对不同类型攻击的影响",
    "learning_objective": "掌握数据执行保护(DEP/NX)的工作原理，理解其对传统Shellcode攻击的防护效果"
  },
  {
    "step_title": "综合防护策略分析",
    "guiding_question": "经过这一系列攻防实验，你认为什么样的防护组合才能真正有效防御缓冲区溢出攻击？单一防护措施足够吗？",
    "success_criteria": "学生能够综合分析各种防护机制的优缺点，提出有效的纵深防御策略",
    "learning_objective": "建立完整的缓冲区溢出攻防知识体系，理解纵深防御的重要性"
  }
]